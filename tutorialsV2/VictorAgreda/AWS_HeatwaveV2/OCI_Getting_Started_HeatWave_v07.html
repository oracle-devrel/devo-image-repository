<div class="techArticleContainer TA01">

  <p class="textTA01">Getting Started with MySQL HeatWave on OCI</p>

  <p class="textTA01">MySQL HeatWave makes perfect sense if you’re running mixed transactional and analytics workloads
    in MySQL, or are
    moving data to a separate database for analytics. Instead of crafting complicated ETL pipelines to move data
    around, HeatWave—a built-in, high performance, in-memory query accelerator—accelerates MySQL performance by orders
    of magnitude for analytics and mixed workloads, without any changes to current applications. The MySQL Database
    Service is built on MySQL Enterprise Edition, which allows developers to quickly create and deploy secure cloud
    native applications using the world’s most popular open source database.</p>

  <p class="textTA01">Oracle designed MySQL HeatWave so developers could focus on their applications. You don’t have
    to manage two
    databases for OLTP and OLAP, and you can get real-time, secure analytics without the complexity, latency, and cost
    of ETL duplication. MySQL HeatWave is a fully managed service automating tasks such as backup, recovery, and
    database and operating system patching. “Worry less, crunch more,” as we say! MySQL HeatWave is developed and
    supported by the MySQL development team at Oracle. </p>

  <p class="textTA01">To get started on OCI, we’ll create a VCN, deploy a MySQL DB System and create a HeatWave
    cluster, pull in some
    data and analyze it. If you’re looking for getting started with MySQL HeatWave on AWS, [click here](LINK TK). That
    will show you how you can leverage MySQL HeatWave in a multi-cloud scenario. What a time to be alive!</p>

  <p class="textTA01">Since we&#8217;re just getting started, let&#8217;s begin truly at the beginning and create a
    VCN with the proper
    access, then see how to create a HeatWave cluster in OCI. </p>

  <h2 id="prerequisites">PREREQUISITES</h2>

  <ul>
    <li>An OCI account and Oracle Cloud Account name</li>
    <li>Admin access</li>
    <li>A compatible browser (Chrome 69+, Safari 12.1+, or Firefox 62+ or any browser that is Oracle Jet-approved)
    </li>
  </ul>

  <h2 id="overview">OVERVIEW</h2>

  <ol>
    <li>Create a VCN and configure for database access</li>
    <li>Create users and groups (if you haven&#8217;t already)</li>
    <li>Create a DB System with HeatWave-compatible shape</li>
    <li>Connect to Cloud Shell and use MySQL Shell</li>
    <li>Import sample data</li>
    <li>Add HeatWave Cluster</li>
    <li>Run queries!</li>
  </ol>

  <p class="textTA01">In our example, we’re using a streamlined approach to set things up to use HeatWave. </p>

  <p class="textTA01">Now let’s get started with the basics! </p>

  <ol>
    <li>
      <p class="textTA01"><strong>Create a VCN and configure for database access</strong></p>

      <p class="textTA01">Menu: Home &gt; Networking &gt; Virtual Cloud Networks</p>

      <p class="textTA01">Create VCN and subnets using Virtual Cloud Networks &gt; Start VCN Wizard &gt; Create a VCN
        with Internet
        Connectivity. Of course you&#8217;ll get a private subnet as well.</p>

      <figure>
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/start_a_vcn_wizard-devrel0622va.png"
          alt="VCN Wizard" title="VCN Wizard" />
        <figcaption>VCN Wizard</figcaption>
      </figure>

      <p class="textTA01">The handy wizard will walk you through creating a network environment for your system,
        although there are
        lots of ways to configure this, let’s not get distracted. Notice that I chose the compartment I set up
        earlier, my_heatwave_testing &#8211; because that&#8217;s important!</p>

      <figure>
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/vcn_config_screen2-devrel0622va.png"
          alt="VCN Config" />
        <figcaption>VCN Config</figcaption>
      </figure>

      <p class="textTA01">Now let&#8217;s configure the VCN&#8217;s security list to allow traffic through MySQL
        Database Service
        ports. Click on the Private Subnet for the VCN you created and click the Security List for it. </p>

      <figure>
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/vcn_edit_subnet_s1-devrel0622va.png"
          alt="Security List" title="Security list" />
        <figcaption>Security List</figcaption>
      </figure>

      <p class="textTA01">Now click Add Security list.</p>

      <p class="textTA01">We&#8217;ll add some ingress rules needed to enable the right ports, 3306 and 33060.
        Here&#8217;s the
        details:</p>
      <pre><code>Source CIDR: 0.0.0.0/0

Destination Port Range: 3306,33060

Description: MySQL Port</code></pre>

      <p class="textTA01">And click Add Ingress Rules.</p>

      <figure>
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/vcn_ingress_rules_example-devrel0622va.png"
          alt="Ingress rules" title="Ingress rules" />
        <figcaption>Ingress rules</figcaption>
      </figure>

      <p class="textTA01">Looking good so far!</p>
    </li>
    <li>
      <p class="textTA01"><strong>Create users and groups (if you haven&#8217;t already)</strong></p>

      <p class="textTA01">If you&#8217;re already the admin, you can skip to the next step, but this is here in case
        you&#8217;re
        adding users to the OCI tenancy who might also need access to manage the DB System. We’ll need to set
        permissions and limit access somewhat, even in our “streamlined” example, but you can <a target="_blank"
          class="textLinkTA01" href="https://docs.oracle.com/en-us/iaas/Content/Identity/Tasks/managinggroups.htm">read
          all about managing
          groups here</a>. Usually we&#8217;ll create a group, create policies, then add users to the group. </p>

      <p class="textTA01">Let’s make friends with the Identity and Security options. </p>

      <p class="textTA01">Create a group for your users; in my example I’ve created a group called MySQL Admins.</p>

      <p class="textTA01">Add users to the group. In our example, we’ll add ourselves to this group. </p>

      <p class="textTA01">Of course, for a group you’ll first create all the users you need, add those into the group
        needing access at
        the levels you determine, and rest assured that you can set them loose with appropriate access controls.</p>

      <p class="textTA01">We allow access by setting policies, allowing one group to have full access (admins), and a
        group with
        limited access (database users, for example). </p>

      <p class="textTA01">Sample policies:</p>
      <pre><code>Allow group MySQLAdmins to {SUBNET_READ, SUBNET_ATTACH, SUBNET_DETACH, VCN_READ, COMPARTMENT_INSPECT} in tenancy

Allow group MySQLAdmins to manage mysql-family in tenancy

Allow group MySQLAdmins to use tag-namespaces in tenancy</code></pre>

      <p class="textTA01">This is just making it possible to configure and administrate our compartment, and defines
        the scope of the
        access applied to the database instance.</p>

      <p class="textTA01">For more on adding users and setting policies in OCI, refer to <a target="_blank"
          class="textLinkTA01" href="https://docs.oracle.com/en-us/iaas/Content/GSG/Tasks/addingusers.htm#Add">this
          documentation</a>.</p>
    </li>
    <li>
      <p class="textTA01"><strong>Create a DB System with HeatWave compatible shape</strong></p>

      <p class="textTA01">Menu &gt; Databases &gt; DB Systems</p>

      <p class="textTA01"><em>Create DB System</em></p>

      <p class="textTA01">Notice that the system warns you if you haven&#8217;t already set up users, a VCN, and so
        on. That&#8217;s
        nice. Don&#8217;t forget to check which compartment you&#8217;ll create this in, again under List Scope on the
        left. Click Create DB System.</p>

      <figure>
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/providedbsysinfo-hwdevrel1022.jpg"
          alt="" />
      </figure>

      <p class="textTA01">Double-check the compartment, give it a name, and select HeatWave (of course).</p>

      <p class="textTA01"><img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/create-admincreds-hwdevrel1022.jpg"
          alt="" /><br />
        You&#8217;ll create admin credentials, be sure to save those somewhere handy but safe.</p>

      <p class="textTA01">In Configure Networking, you&#8217;ll use the Virtual Cloud Network created earlier, but
        we&#8217;ll use the
        private subnet. Leave the default Availability Domain and go to Configure Hardware.</p>

      <figure>
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/availdomain-mysqlhw-oci-devrel1022.jpg"
          alt="" />
      </figure>

      <p class="textTA01">Confirm that in the Configure Hardware section, the selected shape is
        MySQL.HeatWave.VM.Standard.E3.<br />
        Also:<br />
        - CPU Core Count: 16,<br />
        - Memory Size: 512 GB,<br />
        - Data Storage Size: 1024</p>

      <figure>
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/confighwardware-mysqlhw-devrel1022.jpg"
          alt="" />
      </figure>

      <p class="textTA01">In the Configure Backup section you may leave the default backup window of 7 days.<br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/configbackup-oci-mysqlhw-devrel1022.jpg"
          alt="" />
      </p>

      <p class="textTA01">Keep scrolling and click Show Advanced Options.</p>

      <p class="textTA01">Go to the Networking tab, in the Hostname field enter the exact name of your DB System. This
        will enable your
        cluster to register with DNS and allow you to access the host via fully qualified domain name (FQDN).<br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/networktab-oci-mysqlhw-devrel1022.jpg"
          alt="" />
      </p>

      <p class="textTA01">Make sure port configuration corresponds to the following:<br />
        - MySQL Port: 3306<br />
        - MySQL X Protocol Port: 33060</p>

      <p class="textTA01">For this example, we are going to import data automatically during resource creation using
        data stored in an
        Object Storage bucket, made available via Pre-Authenticated Request (PAR).<br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/parimport-oci-mysqlhw-devrel1022.jpg"
          alt="" />
      </p>

      <p class="textTA01">If you would prefer to load the data using the MySQL Shell, you can skip this step.</p>

      <p class="textTA01">Select the Data Import tab. You will be prompted to paste the URL for your PAR here. The
        object PAR URL needs
        to be a manifest file that can be created with the ociParaMifest option of MySQL Shell dump utilityHere. You
        can also use an Object Storage Bucket PAR or Objects with Prefix PAR. </p>

      <p class="textTA01">Here is a sample link you can use to import Airport-DB for trial purposes.</p>
      <pre><code>https://objectstorage.us-ashburn-1.oraclecloud.com/p/zRBSs7nKURyZRcIoV4QlYhascC5gkZcJeQoBS8c2ssyEPID3PSDAnh73OMClQQH4/n/idazzjlcjqzj/b/airportdb-bucket-10282022/o/airportdb/@.manifest.json</code></pre>

      <p class="textTA01">All set&#8230; click Create!</p>

      <p class="textTA01">This time a yellow hexagon will appear, eventually it&#8217;ll turn green and your DB System
        will be up and
        running. Make some tea or grab a glass of water, you&#8217;ve done a lot.</p>
    </li>
    <li>
      <p class="textTA01"><strong>Connect and use MySQL Shell</strong></p>

      <p class="textTA01">Let’s use the handy Cloud Shell to connect to MySQL and MySQL Shell. It’s a little Linux
        terminal embedded in
        the OCI dashboard (and it’s adorable). In the upper right corner, click the Cloud Shell prompt icon and a
        command line will open at the bottom of the browser. Make sure to configure Private Network Setup for your
        cloud shell, selecting the VCN that was created previously.<br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/cloudshell-pn-oci-mysqlhw-devrel1022.jpg"
          alt="" /><br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/pnsetup-oci-mysqlhw-devrel1022.jpg"
          alt="" />
      </p>

      <p class="textTA01">The cool thing is, MySQL Shell is already installed!</p>

      <p class="textTA01">Once we create our HeatWave-compatible DB System, we&#8217;ll connect to it using the MySQL
        Shell.
        <code>mysqlsh --host &lt;DBSystemEndpointIPAddress&gt; -u &lt;Username&gt; -p</code>
      </p>

      <p class="textTA01">You can <a target="_blank" class="textLinkTA01"
          href="https://dev.mysql.com/doc/mysql-shell/8.0/en/">learn
          more about MySQL Shell here</a>.</p>

      <p class="textTA01">More on <a target="_blank" class="textLinkTA01"
          href="https://docs.oracle.com/en-us/iaas/mysql-database/doc/connecting-db-system.html#GUID-70023ABD-5418-4C1F-975F-F3E2ABC0F93E">connecting
          database systems here</a>. </p>
    </li>
    <li>
      <p class="textTA01"><strong>Import data</strong></p>

      <p class="textTA01">If you chose to import data during resource creation using the PAR option, you can skip this
        step. Else you
        can continue here to import AirportDB <a target="_blank" class="textLinkTA01"
          href="https://downloads.mysql.com/docs/airportdb-en.pdf">read more
          about that here</a>. </p>

      <p class="textTA01">In Cloud Shell:</p>
      <pre><code class="console">wget https://downloads.mysql.com/docs/airport-db.tar.gz
tar xvzf airport-db.tar.gz</code></pre>

      <p class="textTA01">This creates a single directory named airport-db, which contains the data files.</p>

      <p class="textTA01">Start MySQL shell and connect to the MySQL DB System Endpoint:</p>

      <p class="textTA01"><code>mysqlsh _Username@DBSystem_IP_Address_or_host_Name</code></p>

      <p class="textTA01">When prompted, enter the admin password you specified earlier. Once connected, you will use
        the Dump Loading
        Utility to import data.</p>

      <p class="textTA01">
        <code>MySQL&gt;JS&gt; util.loadDump(&quot;airport-db&quot;, {threads: 16, deferTableIndexes: &quot;all&quot;, ignoreVersion: true})</code>
      </p>

      <p class="textTA01">It should take a few minutes to import, then you&#8217;re ready to move on!</p>
    </li>
    <li>
      <p class="textTA01"><strong>Add HeatWave Cluster</strong></p>

      <p class="textTA01">HeatWave is really designed for big data sets, needing fast analysis, so even though I’m
        importing a mere
        sample database, you can load up as much as you like (provided you have allocated the storage for it). Plus,
        queries can be run in the cluster without offloading to a separate database. It may take a few minutes for the
        cluster to be created.</p>

      <p class="textTA01">To get started, go to your DB System in the OCI Console: Databases &gt; DB Systems &gt; and
        click on your
        recently-created DB System. </p>

      <p class="textTA01">Under Resources, you&#8217;ll see HeatWave (among other handy items), click that.<br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/resources-hwmysql-devrel-101422.png"
          alt="" />
      </p>

      <p class="textTA01">Of course, you want to Add HeatWave Cluster (using the button on the right, midway down the
        page), or click
        the More actions menu up top and select Add Heatwave cluster. Accept the defaults (16 CPU core with 512GB RAM
        and 1 node), then click the button to Add HeatWave cluster.</p>

      <p class="textTA01"><img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/oci-heatwave-addcluster.jpg"
          alt="" /><br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/oci-create-cluster.jpg"
          alt="" />
      </p>

      <p class="textTA01">This takes a few minutes so you can go reheat that beverage while the cluster spins up.</p>
    </li>
    <li>
      <p class="textTA01"><strong>Load data to HeatWave and Run Queries</strong></p>

      <p class="textTA01">Finally, the fun part! Once the HeatWave Cluster is running:</p>

      <ol>
        <li>
          <p class="textTA01">Start MySQL Shell and connect to the MySQL DB System&#8217;s endpoint: </p>
          <pre><code>$&gt; mysqlsh Username@DBSystem_IP_Address_or_Host_Name</code></pre>
        </li>
        <li>
          <p class="textTA01">Change the MySQL Shell execution mode to SQL:</p>
          <pre><code>MySQL&gt;JS&gt; \sql</code></pre>
        </li>
        <li>
          <p class="textTA01">Change to the airportdb database:</p>

          <pre><code>MySQL&gt;SQL&gt; USE airportdb;  
Default schema set to `airportdb`.Fetching table and column names from `airportdb` for  
auto-completion... Press ^C to stop.`
</code></pre>
        </li>
        <li>
          <p class="textTA01">Load data from MySQL InnoDB to HeatWave</p>
          <pre><code>MySQL&gt;SQL&gt; call 
sys.heatwave_load(JSON_ARRAY(&ldquo;airportdb&rdquo;), NULL);	</code></pre>
        </li>
        <li>
          <p class="textTA01">Use EXPLAIN to verify that the query can be offloaded to the HeatWave Cluster:<br />
            <img
              src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/mysql-explain-devrel-101422.png"
              alt="" />
          </p>

          <p class="textTA01"><strong>Note:</strong> If the query can be offloaded, the Extra column in the EXPLAIN
            output reports
            &#8220;Using secondary engine RAPID&#8221;. </p>
        </li>
        <li>
          <p class="textTA01">After verifying that the query can be offloaded, run the query and note the execution
            time.<br />
            <img
              src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/mysqlhw-query01-devrel-101422.png"
              alt="" />
          </p>
        </li>
      </ol>

      <p class="textTA01">Now, let&#8217;s see how long this would take using the &#8220;plain vanilla&#8221; MySQL DB
        System. We do
        that by disabling <code>use_secondary_engine variable</code><br />
        <img
          src="https://raw.githubusercontent.com/oracle-devrel/devo-image-repository/Devo/images/AWS_HeatwaveV2/mysql-query-slow-devrel-1014.png"
          alt="" />
      </p>
    </li>
  </ol>

  <h3 id="summary">Summary</h3>

  <p class="textTA01">What we’ve done so far, all on OCI, is set up a Virtual Cloud Network with ports for MySQL use,
    set up a MySQL
    database, and add a HeatWave cluster. We then imported some test data and ran a couple of queries to see the speed
    of HeatWave versus the DB System on its own. </p>

  <p class="textTA01">Want to know more? Join the discussion in our <a target="_blank" class="textLinkTA01"
      href="https://bit.ly/odevrel_slack">public Slack channel</a>!
  </p>

</div>